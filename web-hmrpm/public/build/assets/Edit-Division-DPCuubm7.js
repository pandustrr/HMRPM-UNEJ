import{u as I,r as l,j as e,H as B,L as m,b as w}from"./app-BDE2AaDe.js";import{A as T}from"./AdminLayout-DRLIiVFN.js";import{S as G,I as H}from"./ImageCropper-uI6iYpD8.js";import O from"./Detail-Member-D2FpA1_K.js";import{A as q}from"./arrow-left-blQlcDK1.js";import{U as y}from"./users-BV1tXCkV.js";import{P as K,S as J}from"./square-pen-UgTrjlaW.js";import{E as Q}from"./eye-DRN5bZNc.js";import{T as k}from"./trash-2-CTb1tNdp.js";import{U as g}from"./upload-CSZiJDLr.js";import{S as V}from"./save-bM1Gya_5.js";import"./file-text-BipYlanU.js";import"./graduation-cap-DAsRhiDT.js";import"./index-C0R1yrz4.js";import"./chevron-right-q_Th7CUI.js";import"./chevron-left-Db9v-oEa.js";import"./chevron-down-Dtr0tCQU.js";import"./Toast-wOax5C-Q.js";import"./Modal-D_7cxuF7.js";function W({division:s}){const{data:t,setData:n,post:X,processing:h,errors:o}=I({name:s.name||"",short_desc:s.short_desc||"",description:s.description||"",color:s.color||"#dc2626",icon_image:null,image:null}),[_,c]=l.useState(!1),[f,b]=l.useState(null),[S,j]=l.useState(null),[C,N]=l.useState(0),[D,u]=l.useState(!1),[i,p]=l.useState(null),[U,v]=l.useState(!1),[z,L]=l.useState(null);l.useEffect(()=>{if(!t.image){j(null);return}const r=URL.createObjectURL(t.image);return j(r),()=>URL.revokeObjectURL(r)},[t.image]),l.useEffect(()=>{},[]);const E=r=>{const a=r.target.files[0];if(a){n("image",a);const d=new FileReader;d.onload=()=>{b(d.result),N(x=>x+1)},d.readAsDataURL(a)}},A=()=>{if(f)c(!0);else if(s.image){const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),b(a.toDataURL("image/jpeg")),N(x=>x+1),c(!0)},r.src=s.image}},F=r=>{n("image",r),c(!1)},M=r=>{r.preventDefault();const a=new FormData;a.append("_method","PUT"),a.append("name",t.name),a.append("short_desc",t.short_desc),a.append("description",t.description),a.append("color",t.color),t.icon_image instanceof File&&a.append("icon_image",t.icon_image),t.image instanceof File&&a.append("image",t.image),w.post(`/admin/divisions/${s.id}`,a,{preserveScroll:!0,forceFormData:!0,onError:d=>{console.error("Update errors:",d)}})},R=r=>{p(r),u(!0)},P=r=>{L(r),v(!0)},$=()=>{i&&w.delete(`/admin/members/${i.id}`,{preserveScroll:!0,onSuccess:()=>{u(!1),p(null)}})};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:`Edit ${s.name}`}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(m,{href:`/admin/divisions?period_id=${s.period_id}`,className:"p-2 hover:bg-muted rounded-lg transition-colors",children:e.jsx(q,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-foreground",children:"Edit Divisi"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Perbarui informasi divisi dan kelola anggota"})]})]})}),e.jsxs("form",{onSubmit:M,className:"max-w-7xl grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-border p-6 space-y-6 shadow-sm",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Informasi Divisi"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Nama Divisi"}),e.jsx("input",{type:"text",value:t.name,onChange:r=>n("name",r.target.value),className:"w-full px-4 py-2.5 bg-white border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-red/20 text-foreground",placeholder:"Nama divisi"}),o.name&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:o.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Nama Lengkap Departemen"}),e.jsx("input",{type:"text",value:t.short_desc,onChange:r=>n("short_desc",r.target.value),className:"w-full px-4 py-2.5 bg-white border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-red/20 text-foreground",placeholder:"Penjelasan singkat fokus divisi"}),o.short_desc&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:o.short_desc})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Deskripsi Lengkap"}),e.jsx("textarea",{value:t.description,onChange:r=>n("description",r.target.value),rows:5,className:"w-full px-4 py-2.5 bg-white border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-red/20 text-foreground",placeholder:"Tuliskan tujuan, program kerja, atau detail lain dari divisi ini..."}),o.description&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:o.description})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-border p-6 space-y-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-foreground",children:[e.jsx(y,{size:24,className:"text-brand-red"}),"Anggota Divisi"]}),e.jsx(m,{href:`/admin/members/create?period_id=${s.period_id}&division_id=${s.id}&division_id_source=${s.id}`,className:"p-2 bg-brand-red text-white rounded-lg hover:bg-brand-red/90 transition-all hover:scale-110 active:scale-95 shadow-lg shadow-red-100",title:"Tambah Anggota",children:e.jsx(K,{size:20})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:s.members&&s.members.length>0?s.members.map(r=>e.jsxs("div",{className:"group flex items-center justify-between p-3 bg-muted/20 hover:bg-muted/40 border border-border/50 rounded-2xl transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-full overflow-hidden border border-border bg-white shrink-0",children:e.jsx("img",{src:r.photo||"/storage/logo/hmrpm.png",alt:r.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:a=>a.target.src="/storage/logo/hmrpm.png"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-bold text-sm text-foreground leading-tight truncate",children:r.name}),e.jsx("p",{className:"text-[10px] font-bold text-brand-red uppercase tracking-wider mt-0.5",children:r.role})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>P(r),className:"p-2 hover:bg-blue-50 rounded-xl transition-colors text-muted-foreground hover:text-blue-600",title:"Detail",children:e.jsx(Q,{size:16})}),e.jsx(m,{href:`/admin/members/${r.id}/edit?division_id_source=${s.id}`,className:"p-2 hover:bg-white rounded-xl transition-colors text-muted-foreground hover:text-foreground",title:"Edit Anggota",children:e.jsx(J,{size:16})}),e.jsx("button",{type:"button",onClick:()=>R(r),className:"p-2 hover:bg-red-50 rounded-xl transition-colors text-muted-foreground hover:text-red-600",title:"Hapus",children:e.jsx(k,{size:16})})]})]},r.id)):e.jsxs("div",{className:"col-span-full text-center py-10 px-4",children:[e.jsx(y,{size:40,className:"mx-auto text-muted-foreground opacity-20 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium underline underline-offset-4 decoration-muted/30",children:"Belum ada anggota"})]})})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-border p-6 space-y-6 shadow-sm",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Media & Gaya"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Icon Divisi (Transparent PNG)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:r=>n("icon_image",r.target.files[0]),className:"hidden",id:"icon-upload"}),e.jsx("label",{htmlFor:"icon-upload",className:"flex flex-col items-center justify-center gap-2 w-32 mx-auto aspect-square border-2 border-dashed border-border rounded-2xl cursor-pointer hover:bg-muted/30 transition-colors group overflow-hidden",children:t.icon_image?e.jsx("img",{src:URL.createObjectURL(t.icon_image),className:"w-full h-full object-contain p-4",alt:"Preview"}):s.icon_image?e.jsx("img",{src:s.icon_image,className:"w-full h-full object-contain p-4",alt:"Current"}):e.jsxs(e.Fragment,{children:[e.jsx(g,{size:24,className:"text-muted-foreground group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-xs font-bold text-muted-foreground",children:"Upload Icon"})]})}),o.icon_image&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:o.icon_image})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Background Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:E,className:"hidden",id:"image-upload"}),e.jsx("div",{className:"relative group overflow-hidden rounded-2xl border-2 border-dashed border-border aspect-video bg-muted/5",children:t.image||s.image?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:S||s.image,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",alt:"Preview"}),e.jsxs("div",{className:"absolute top-3 right-3 flex gap-2",children:[e.jsx("button",{type:"button",onClick:A,className:"p-2 bg-brand-red text-white backdrop-blur-md rounded-xl cursor-pointer border border-white/20 shadow-xl transition-all hover:bg-brand-red/90 hover:scale-110 active:scale-95 group/crop",title:"Potong Gambar",children:e.jsx(G,{size:16,className:"group-hover/crop:rotate-12 transition-transform"})}),e.jsx("label",{htmlFor:"image-upload",className:"p-2 bg-white/20 hover:bg-brand-red backdrop-blur-md rounded-xl cursor-pointer border border-white/20 shadow-xl transition-all group/upload",title:"Ganti Gambar",children:e.jsx(g,{size:16,className:`
                                                            stroke-brand-red
                                                            transition-all duration-200
                                                            group-hover/upload:stroke-white
                                                            group-hover/upload:rotate-12
                                                            group-hover/upload:scale-110
                                                            `})})]})]}):e.jsxs("label",{htmlFor:"image-upload",className:"flex flex-col items-center justify-center gap-2 w-full h-full cursor-pointer hover:bg-muted/30 transition-colors group",children:[e.jsx(g,{size:24,className:"text-muted-foreground group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-xs font-bold text-muted-foreground uppercase tracking-widest font-black",children:"Upload Background"})]})}),e.jsx("p",{className:"text-[10px] text-muted-foreground font-medium italic",children:"* Rasio ideal 16:9 untuk tampilan bg di website."}),e.jsx("p",{className:"text-[10px] text-muted-foreground font-medium italic",children:"Untuk crop ulang gambar yang sudah disimpan, silakan upload ulang background terlebih dahulu."}),o.image&&e.jsx("p",{className:"text-red-600 text-sm mt-1 font-bold",children:o.image})]})]}),e.jsxs("div",{className:"space-y-3 pt-4",children:[e.jsxs("button",{type:"submit",disabled:h,className:"w-full flex items-center justify-center gap-2 px-6 py-2.5 bg-brand-red hover:bg-brand-red/90 text-white rounded-xl font-bold text-sm transition-all disabled:opacity-50 shadow-md shadow-red-200",children:[e.jsx(V,{size:18}),h?"Menyimpan...":"Simpan"]}),e.jsx(m,{href:`/admin/divisions?period_id=${s.period_id}`,className:"w-full block px-6 py-3 bg-muted hover:bg-muted/80 text-foreground rounded-2xl font-bold text-center transition-all",children:"Batal"})]})]})})]}),_&&e.jsx(H,{image:f,aspectRatio:16/9,onCropComplete:F,onCancel:()=>{c(!1)}},`cropper-${C}`)]}),e.jsx(O,{show:U,onClose:()=>v(!1),member:z}),D&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full shadow-[0_25px_50px_-12px_rgba(0,0,0,0.5)] animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-600 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-50 rounded-lg",children:e.jsx(k,{size:24})}),e.jsx("h3",{className:"text-xl font-bold",children:"Hapus Anggota?"})]}),e.jsxs("p",{className:"text-muted-foreground mb-6",children:["Apakah Anda yakin ingin menghapus anggota ",e.jsx("strong",{children:i==null?void 0:i.name}),"? Tindakan ini tidak dapat dibatalkan."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{u(!1),p(null)},className:"flex-1 px-4 py-2.5 bg-muted hover:bg-muted/80 rounded-xl font-bold transition-colors",children:"Batal"}),e.jsx("button",{onClick:$,className:"flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-xl font-bold transition-colors shadow-lg shadow-red-200",children:"Hapus"})]})]})})]})}W.layout=s=>e.jsx(T,{children:s});export{W as default};
