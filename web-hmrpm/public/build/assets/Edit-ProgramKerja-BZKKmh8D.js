import{u as P,r as h,j as e,H as S,L as f,X as v,b as D}from"./app-BQyAt-a0.js";import{A as F}from"./AdminLayout-DvnZABpI.js";import{S as E,I as L}from"./ImageCropper-D1o_3_dx.js";import{A as I}from"./arrow-left-pEe3XHfS.js";import{U}from"./upload-DZmvkkXY.js";import{S as R}from"./save-ij_nJbNJ.js";import"./users-CoWn5egU.js";import"./file-text-BjLhBNnE.js";import"./graduation-cap-CKyIkio2.js";import"./index-YZG5WpAO.js";import"./chevron-right-BSv96KPr.js";import"./chevron-left-PtVmb53x.js";import"./chevron-down-DewqCFWx.js";import"./Toast-DTaku6Zt.js";function z({programKerja:o,divisions:j}){const{data:a,setData:l,post:A,processing:g,errors:i}=P({division_id:o.division_id,title:o.title,event_date:o.event_date,description:o.description,status:o.status||"Progress",documentation:[],existing_documentation:o.documentation||[]}),[d,c]=h.useState([]),[m,u]=h.useState(null),[b,p]=h.useState(null),N=s=>{const t=Array.from(s.target.files);l("documentation",t);const r=t.map(n=>({name:n.name,url:URL.createObjectURL(n),type:n.type,isNew:!0}));c(r)},w=s=>{const t=a.documentation.filter((n,x)=>x!==s);l("documentation",t);const r=d.filter((n,x)=>x!==s);c(r)},y=s=>{const t=a.documentation[s],r=new FileReader;r.onload=()=>{p(r.result),u(s)},r.readAsDataURL(t)},_=s=>{const t=[...a.documentation];t[m]=s,l("documentation",t);const r=[...d];r[m]={...r[m],url:URL.createObjectURL(s)},c(r),p(null),u(null)},k=s=>{const t=a.existing_documentation.filter((r,n)=>n!==s);l("existing_documentation",t)},C=s=>{s.preventDefault();const t=new FormData;t.append("_method","PUT"),t.append("division_id",a.division_id),t.append("title",a.title),t.append("event_date",a.event_date),t.append("description",a.description),t.append("status",a.status),a.existing_documentation.forEach((r,n)=>{t.append(`existing_documentation[${n}]`,r)}),a.documentation.forEach((r,n)=>{t.append(`documentation[${n}]`,r)}),D.post(`/admin/program-kerja/${o.id}`,t,{forceFormData:!0,preserveScroll:!0})};return e.jsxs(e.Fragment,{children:[e.jsx(S,{title:`Edit ${o.title}`}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{href:"/admin/program-kerja",className:"p-2 hover:bg-muted rounded-lg transition-colors",children:e.jsx(I,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-foreground",children:"Edit Program Kerja"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Perbarui informasi program kerja"})]})]}),e.jsx("form",{onSubmit:C,className:"max-w-3xl space-y-6",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-border p-6 space-y-6 shadow-sm",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Informasi Program Kerja"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Divisi"}),e.jsxs("select",{value:a.division_id,onChange:s=>l("division_id",s.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-red/20",children:[e.jsx("option",{value:"",children:"Pilih Divisi"}),j.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.division_id&&e.jsx("p",{className:"text-red-600 text-sm",children:i.division_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Judul Program"}),e.jsx("input",{type:"text",value:a.title,onChange:s=>l("title",s.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-red/20"}),i.title&&e.jsx("p",{className:"text-red-600 text-sm",children:i.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Tanggal Kegiatan"}),e.jsx("input",{type:"date",value:a.event_date,onChange:s=>l("event_date",s.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-red/20"}),i.event_date&&e.jsx("p",{className:"text-red-600 text-sm",children:i.event_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Status Program"}),e.jsxs("select",{value:a.status,onChange:s=>l("status",s.target.value),className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-red/20",children:[e.jsx("option",{value:"Perencanaan",children:"Perencanaan"}),e.jsx("option",{value:"Progress",children:"Progress"}),e.jsx("option",{value:"Selesai",children:"Selesai"})]}),i.status&&e.jsx("p",{className:"text-red-600 text-sm",children:i.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Deskripsi Kegiatan"}),e.jsx("textarea",{value:a.description,onChange:s=>l("description",s.target.value),rows:5,className:"w-full px-4 py-2.5 border border-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-red/20"}),i.description&&e.jsx("p",{className:"text-red-600 text-sm",children:i.description})]}),a.existing_documentation.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Dokumentasi Saat Ini"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:a.existing_documentation.map((s,t)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-video rounded-lg overflow-hidden border border-border",children:s.includes(".mp4")||s.includes(".webm")?e.jsx("video",{src:s,className:"w-full h-full object-cover"}):e.jsx("img",{src:s,className:"w-full h-full object-cover",alt:"Documentation"})}),e.jsx("div",{className:"absolute top-2 right-2 flex gap-1",children:e.jsx("button",{type:"button",onClick:()=>k(t),className:"p-1.5 bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors shadow-lg",children:e.jsx(v,{size:12})})})]},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Tambah Dokumentasi Baru"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",onChange:N,className:"hidden",id:"documentation-upload"}),e.jsxs("label",{htmlFor:"documentation-upload",className:"flex flex-col items-center justify-center gap-2 w-full p-8 border-2 border-dashed border-border rounded-2xl cursor-pointer hover:bg-muted/30 transition-colors",children:[e.jsx(U,{size:24,className:"text-muted-foreground"}),e.jsx("span",{className:"text-sm font-bold text-muted-foreground",children:"Pilih file atau tarik kesini"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"JPG, PNG, MP4 (Maks. 20MB per file)"})]}),d.length>0&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mt-4",children:d.map((s,t)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-video rounded-lg overflow-hidden border border-border",children:s.type.startsWith("video/")?e.jsx("video",{src:s.url,className:"w-full h-full object-cover"}):e.jsx("img",{src:s.url,className:"w-full h-full object-cover",alt:s.name})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[!s.type.startsWith("video/")&&e.jsx("button",{type:"button",onClick:()=>y(t),className:"p-1.5 bg-brand-red text-white rounded-full hover:bg-brand-red/90 transition-colors shadow-lg",children:e.jsx(E,{size:12})}),e.jsx("button",{type:"button",onClick:()=>w(t),className:"p-1.5 bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors shadow-lg",children:e.jsx(v,{size:12})})]})]},t))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(f,{href:"/admin/program-kerja",className:"flex-1 px-4 py-3 bg-muted hover:bg-muted/80 rounded-xl font-bold text-center transition-colors",children:"Batal"}),e.jsxs("button",{type:"submit",disabled:g,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-brand-red hover:bg-brand-red/90 text-white rounded-xl font-bold shadow-lg shadow-brand-red/20 transition-all disabled:opacity-50",children:[e.jsx(R,{size:20}),g?"Menyimpan...":"Simpan Perubahan"]})]})]})})]}),b&&e.jsx(L,{image:b,onCropComplete:_,onCancel:()=>{p(null),u(null)}})]})}z.layout=o=>e.jsx(F,{children:o});export{z as default};
